window.njt.id=new function(){this.lazyUniqueId=Date.now(),this.getLazyUniqueId=function(){return result=this.lazyUniqueId,this.lazyUniqueId++,result}},window.njt.element=new function(){this.createElement=function(t,e,n,i,l){let o=null;if(window.njt.js.typeOf(t)===window.njt.types.STRING){if(""===t)return document.createTextNode(l);if(o=document.createElement(t),window.njt.js.typeOf(i)===window.njt.types.OBJECT){let t=Object.keys(i);for(let e=0,n=t.length;e<n;++e){var s=t[e];o.setAttribute(s,i[s])}}window.njt.js.typeOf(e)===window.njt.types.STRING&&o.setAttribute("id",e),window.njt.js.typeOf(n)===window.njt.types.STRING&&(o.className=n),window.njt.js.typeOf(l)!==window.njt.types.STRING&&window.njt.js.typeOf(l)!==window.njt.types.NUMBER&&window.njt.js.typeOf(l)!==window.njt.types.BIGINT||(o.innerHTML=l)}return o},this.wrapElement=function(t,e){let n=window.njt.element.buildElementTree(t);return n.appendChild(e),n},this.buildElementTree=function(t){let e=null;if(window.njt.js.typeOf(t)===window.njt.types.OBJECT&&(e=this.createElement(t.t,t.i,t.c,t.a,t.h),null!==e)){if(window.njt.js.typeOf(t.e)===window.njt.types.ARRAY)for(let n=0;n<t.e.length;n++){let i=this.buildElementTree(t.e[n]);null!==i&&e.appendChild(i)}window.njt.js.typeOf(t.w)===window.njt.types.OBJECT&&(e=this.wrapElement(t.w,e))}return e}},window.njt.snip=new function(){this.caseSensitive=!1,this.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","gi"),this.valueMap=new Object,this.snipMap=new Object,this.vars=new Array,this.setCaseSensitive=function(t){1==t?(window.njt.snip.caseSensitive=!0,window.njt.snip.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","g")):(window.njt.snip.caseSensitive=!1,window.njt.snip.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","gi"))},this.valueMapPush=function(t,e){this.caseSensitive||(t=t.toLowerCase()),this.valueMap[t]=e},this.valueMapDelete=function(t){this.caseSensitive||(t=t.toLowerCase()),void 0!==this.valueMap[t]&&delete this.valueMap[t]},this.valueMapClear=function(){this.valueMap=new Object},this.examineString=function(t){let e=new Array,n=null,i=null;for(;null!==(n=this.regex.exec(t));)i=this.caseSensitive?n[1]:n[1].toLowerCase(),-1===e.indexOf(i)&&e.push(i),-1===this.vars.indexOf(i)&&this.vars.push(i);return e},this.examineById=function(t){let e=new Array,n=window.njt.dom.getElementsByAttributeWithValue("snip-id",t);return 1===n.length&&(e=this.examineString(n[0].innerHTML)),e},this.examineByGroup=function(t){let e=new Array,n=window.njt.dom.getElementsByAttributeWithValue("snip-group",t);if(n.length>0)for(let t=0;t<n.length;t++){let i=this.examineString(n[t].innerHTML);for(let t=0;t<i.length;t++)-1==e.indexOf(i[t])&&e.push(i[t])}return e},this.processString=function(t){let e="",n=new Array,i=null;for(;null!==(i=this.regex.exec(t));){let t={};t.i=i.index,t.l=i[0].length,n.push(t)}index=0;for(let i=0;i<n.length;i++){let l=n[i];l.i!==index&&(e+=t.substring(index,l.i)),index=l.i+l.l;let o=t.substring(l.i+2,index-2);this.caseSensitive||(o=o.toLowerCase()),void 0===this.valueMap[o]?e+="{:"+o+":}":e+=this.valueMap[o]}return index<t.length&&(e+=t.substring(index,t.length)),e},this.processById=function(t){let e=window.njt.dom.getElementsByAttributeWithValue("snip-id",t);1===e.length&&(void 0===this.snipMap[t]&&(this.snipMap[t]=e[0].innerHTML),e[0].innerHTML=this.processString(this.snipMap[t]))},this.processByGroup=function(t){let e=window.njt.dom.getElementsByAttributeWithValue("snip-group",t);if(e.length>0)for(let n=0;n<e.length;n++){let i=e[n].getAttribute("snip-id");null===i&&(i=t+window.njt.id.getLazyUniqueId(),e[n].setAttribute("snip-id",i)),void 0===this.snipMap[i]&&(this.snipMap[i]=e[n].innerHTML),e[n].innerHTML=this.processString(this.snipMap[i])}},this.resetById=function(t){let e=window.njt.dom.getElementsByAttributeWithValue("snip-id",t);1===e.length&&void 0!==this.snipMap[t]&&(e[0].innerHTML=this.snipMap[t])},this.resetByGroup=function(t){let e=window.njt.dom.getElementsByAttributeWithValue("snip-group",t);if(e.length>0)for(let t=0;t<e.length;t++){let n=e[t].getAttribute("snip-id");null!==n&&void 0!==this.snipMap[n]&&(e[t].innerHTML=this.snipMap[n])}},this.initByClass=function(t){let e=0,n=window.njt.dom.getElementsByClass(t);for(let i=0;i<n.length;i++)null===n[i].getAttribute("snip-group")&&null===n[i].getAttribute("snip-id")&&(n[i].setAttribute("snip-group",t),snipId=t+window.njt.id.getLazyUniqueId(),n[i].setAttribute("snip-id",snipId),e++);return e},this.initByClassIdPair=function(t){let e=0,n=window.njt.dom.getElementsWhereClassBegins(t+"-"),i=t.length+2;for(let l=0;l<n.length;l++)for(let o=0;o<n[l].classList.length;o++){let s=n[l].classList[o];s.length>i&&s.substring(0,t.length)===t&&null===n[l].getAttribute("snip-group")&&null===n[l].getAttribute("snip-id")&&(n[l].setAttribute("snip-group",t),n[l].setAttribute("snip-id",s.substring(t.length+1)),e++)}return e}},window.njt.modal=new function(){this.initModal=function(){this.modalShell=document.createDocumentFragment();let t=document.createElement("div");t.setAttribute("id",this.modalBackgroundId),t.setAttribute("modal-element","background"),t.className=this.modalBackgroundClass;let e=document.createElement("div");e.setAttribute("id",this.modalFrameId),e.className=this.modalFrameClass;let n=document.createElement("div");n.setAttribute("id",this.modalCloseWrapperId);let i=document.createElement("span");i.innerHTML="&times;",i.className=this.modalCloseClass,i.setAttribute("id",this.modalCloseId),i.setAttribute("modal-element","close-button");let l=document.createElement("div");l.setAttribute("id",this.modalContentId),l.className=this.modalContentClass,n.appendChild(i),e.appendChild(n),e.appendChild(l),t.appendChild(e),this.modalShell.appendChild(t),document.addEventListener("mousedown",(function(t){let e=t.target.getAttribute("modal-element");null!==e?t.offsetX<t.target.clientWidth&&(window.njt.modal.lastClick=e):window.njt.modal.lastClick=null})),document.addEventListener("mouseup",(function(t){if(null!==window.njt.modal.lastClick){let e=t.target.getAttribute("modal-element");e===window.njt.modal.lastClick&&("background"!==e&&"close-button"!==e||t.offsetX<t.target.clientWidth&&window.njt.modal.close(t)),window.njt.modal.lastClick=null}}))},this.loadModals=function(){let t=document.querySelectorAll("[modal-wrapper]"),e=null,n=null,i=null;t.length;for(let l=0;l<t.length;l++){for(e=t[l].getAttribute("modal-wrapper"),n=t[l].getAttribute("modal-open"),i=t[l].getAttribute("modal-close"),currentChildren=t[l].children,this.contentArray[e]={},this.contentArray[e].modal=document.createDocumentFragment();currentChildren.length>0;)this.contentArray[e].modal.appendChild(currentChildren[0]);this.contentArray[e].open="string"==typeof n?n:null,this.contentArray[e].close="string"==typeof i?i:null,t[l].parentNode.removeChild(t[l])}},this.open=function(t,e){window.njt.log("Trying To Open Modal"),null!=this.contentArray[t].open?(window.njt.log("Running Custom Open Modal Function"),window.njt.modal.openFunctions[this.contentArray[t].open](t,e)):this.openNow(t)},this.openNow=function(t){window.njt.log("Modal Open Started"),null===this.currentContentId&&"string"==typeof t&&void 0!==this.contentArray[t]&&(window.njt.modal.modalShell.querySelector("#"+this.modalContentId).appendChild(this.contentArray[t].modal),document.body.appendChild(this.modalShell),this.currentContentId=t),window.njt.log("Modal Open Ended")},this.close=function(t){window.njt.log("Trying To Close Modal"),null!=this.contentArray[this.currentContentId].close?(window.njt.log("Running Custom Close Modal Function"),window.njt.modal.closeFunctions[this.contentArray[this.currentContentId].close](t)):this.closeNow()},this.closeNow=function(){if(window.njt.log("Modal Close Started"),null!==this.currentContentId){let t=document.getElementById(this.modalContentId);for(;t.childNodes.length>0;)this.contentArray[this.currentContentId].modal.appendChild(t.childNodes[0]);this.modalShell.appendChild(document.getElementById(this.modalBackgroundId)),this.currentContentId=null}window.njt.log("Modal Close Ended")},this.modalShell=null,this.currentContentId=null,this.contentArray=[],this.modalBackgroundId="modal-background",this.modalBackgroundClass="modal-background",this.modalFrameId="modal-frame",this.modalFrameClass="modal-frame",this.modalCloseWrapperId="modal-close-wrapper",this.modalCloseId="modal-close-button",this.modalCloseClass="modal-close",this.modalContentId="modal-content",this.modalContentClass="modal-content",this.lastClick=null,this.contentArray=[],this.openFunctions={},this.closeFunctions={},window.njt.event.queue.htmlloaded.push((function(){window.njt.log("Starting to initialise Modals"),window.njt.modal.initModal(),window.njt.modal.loadModals(),window.njt.log("Finished initialising Modals")}))},window.njt.formbuilder=new function(){this.generate=function(t){let e=null;if(window.njt.js.typeOf(t)===window.njt.types.STRING&&(t=JSON.parse(t)),"njt/form"===t.t){if(e=window.njt.element.createElement("form",t.i,t.c,t.a),window.njt.js.typeOf(t.e)===window.njt.types.ARRAY)for(let n=0;n<t.e.length;n++){let i=null,l=(t.e[n],t.e[n].t.split("/"));3===l.length?"njt"===l[0]&&"form"===l[1]&&window.njt.js.typeOf(this.typeBuilders[l[2]])===window.njt.types.FUNCTION&&(i=this.typeBuilders[l[2]](t.e[n])):1===l.length&&(i=window.njt.element.buildElementTree(t.e[n])),null!==i&&e.appendChild(i)}if(window.njt.js.typeOf(t.w)===window.njt.types.OBJECT){let n=window.njt.element.createElement(t.w.t,t.w.i,t.w.c,t.w.a);n.appendChild(e),e=n}}return e},this.typeBuilders={},this.typeBuilders.lineinput=function(t){let e=null;if(window.njt.js.typeOf(t.i)===window.njt.types.STRING){t.l;let n=t.i,i={type:"text",class:"njt-form-lineinput",name:n};window.njt.js.typeOf(t.p)===window.njt.types.STRING&&(i.placeholder=t.p),e=window.njt.element.createElement("div",n+"-wrapper",t.c);let l=window.njt.element.createElement("input",n+"-input",null,i);if(window.njt.js.typeOf(t.l)===window.njt.types.STRING){let i=window.njt.element.createElement("label",n+"-label",null,{for:n+"-input"},t.l+l.outerHTML);e.appendChild(i)}else e.appendChild(l)}return e},this.typeBuilders.multilineinput=function(t){let e=null;if(window.njt.js.typeOf(t.i)===window.njt.types.STRING){t.l;let n=t.i,i={class:"njt-form-multilineinput",name:n};window.njt.js.typeOf(t.p)===window.njt.types.STRING&&(i.placeholder=t.p),e=window.njt.element.createElement("div",n+"-wrapper",t.c);let l=window.njt.element.createElement("textarea",n+"-input",null,i);if(window.njt.js.typeOf(t.l)===window.njt.types.STRING){let i=window.njt.element.createElement("label",n+"-label",null,{for:n+"-input"},t.l+l.outerHTML);e.appendChild(i)}else e.appendChild(l)}return e},this.typeBuilders.dropdown=function(t){let e=null;if(window.njt.js.typeOf(t.i)===window.njt.types.STRING){t.l;let n=t.i,i={class:"njt-form-dropdown",name:n},l=null;window.njt.js.typeOf(t.s)===window.njt.types.STRING&&(l=t.s),e=window.njt.element.createElement("div",n+"-wrapper",t.c);let o=window.njt.element.createElement("select",n+"-input",null,i);if(window.njt.js.typeOf(t.v)===window.njt.types.ARRAY)for(let e=0;e<t.v.length;e++)t.v[e].v===l?o.appendChild(window.njt.element.createElement("option",null,null,{value:t.v[e].v,selected:1},t.v[e].h)):o.appendChild(window.njt.element.createElement("option",null,null,{value:t.v[e].v},t.v[e].h));if(window.njt.js.typeOf(t.l)===window.njt.types.STRING){let i=window.njt.element.createElement("label",n+"-label",null,{for:n+"-input"},t.l+o.outerHTML);e.appendChild(i)}else e.appendChild(o)}return e}};