njt.id=new function(){this.lazyUniqueId=Date.now(),this.getLazyUniqueId=function(){return result=this.lazyUniqueId,this.lazyUniqueId++,result}},njt.element=new function(){this.createElement=function(e,t,n,s,o){let i=null;if(njt.js.typeOf(e)===njt.types.STRING){if(e==="")return document.createTextNode(o);if(i=document.createElement(e),njt.js.typeOf(s)===njt.types.OBJECT){let e=Object.keys(s);for(let t=0,n=e.length;t<n;++t){var a=e[t];i.setAttribute(a,s[a])}}njt.js.typeOf(t)===njt.types.STRING&&i.setAttribute("id",t),njt.js.typeOf(n)===njt.types.STRING&&(i.className=n),(njt.js.typeOf(o)===njt.types.STRING||njt.js.typeOf(o)===njt.types.NUMBER||njt.js.typeOf(o)===njt.types.BIGINT)&&(i.innerHTML=o)}return i},this.wrapElement=function(e,t){let n=njt.element.buildElementTree(e);return n.appendChild(t),n},this.buildElementTree=function(e){let t=null;if(njt.js.typeOf(e)===njt.types.OBJECT&&(t=this.createElement(e.t,e.i,e.c,e.a,e.h),t!==null)){if(njt.js.typeOf(e.e)===njt.types.ARRAY)for(let n=0;n<e.e.length;n++){let s=this.buildElementTree(e.e[n]);s!==null&&t.appendChild(s)}njt.js.typeOf(e.w)===njt.types.OBJECT&&(t=this.wrapElement(e.w,t))}return t}},njt.snip=new function(){this.caseSensitive=!1,this.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","gi"),this.valueMap=new Object,this.snipMap=new Object,this.vars=new Array,this.setCaseSensitive=function(e){e==!0?(njt.snip.caseSensitive=!0,njt.snip.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","g")):(njt.snip.caseSensitive=!1,njt.snip.regex=new RegExp("{:([a-zA-Z0-9=.-_]*):}","gi"))},this.valueMapPush=function(e,t){this.caseSensitive||(e=e.toLowerCase()),this.valueMap[e]=t},this.valueMapDelete=function(e){this.caseSensitive||(e=e.toLowerCase()),typeof this.valueMap[e]!="undefined"&&delete this.valueMap[e]},this.valueMapClear=function(){this.valueMap=new Object},this.examineString=function(e){let n=new Array,s=null,t=null;for(;(s=this.regex.exec(e))!==null;)this.caseSensitive?t=s[1]:t=s[1].toLowerCase(),n.indexOf(t)===-1&&n.push(t),this.vars.indexOf(t)===-1&&this.vars.push(t);return n},this.examineById=function(e){let t=new Array,n=njt.dom.getElementsByAttributeWithValue("snip-id",e);return n.length===1&&(t=this.examineString(n[0].innerHTML)),t},this.examineByGroup=function(e){let t=new Array,n=njt.dom.getElementsByAttributeWithValue("snip-group",e);if(n.length>0)for(let e=0;e<n.length;e++){let s=this.examineString(n[e].innerHTML);for(let e=0;e<s.length;e++)t.indexOf(s[e])==-1&&t.push(s[e])}return t},this.processString=function(e){let t="",n=new Array,s=null;for(;(s=this.regex.exec(e))!==null;){let e={};e.i=s.index,e.l=s[0].length,n.push(e)}index=0;for(let i=0;i<n.length;i++){let s=n[i];s.i!==index&&(t+=e.substring(index,s.i)),index=s.i+s.l;let o=e.substring(s.i+2,index-2);this.caseSensitive||(o=o.toLowerCase()),typeof this.valueMap[o]=="undefined"?t+="{:"+o+":}":t+=this.valueMap[o]}return index<e.length&&(t+=e.substring(index,e.length)),t},this.processById=function(e){let t=njt.dom.getElementsByAttributeWithValue("snip-id",e);t.length===1&&(typeof this.snipMap[e]=="undefined"&&(this.snipMap[e]=t[0].innerHTML),t[0].innerHTML=this.processString(this.snipMap[e]))},this.processByGroup=function(e){let t=njt.dom.getElementsByAttributeWithValue("snip-group",e);if(t.length>0)for(let n=0;n<t.length;n++){let s=t[n].getAttribute("snip-id");s===null&&(s=e+njt.id.getLazyUniqueId(),t[n].setAttribute("snip-id",s)),typeof this.snipMap[s]=="undefined"&&(this.snipMap[s]=t[n].innerHTML),t[n].innerHTML=this.processString(this.snipMap[s])}},this.resetById=function(e){let t=njt.dom.getElementsByAttributeWithValue("snip-id",e);t.length===1&&typeof this.snipMap[e]!="undefined"&&(t[0].innerHTML=this.snipMap[e])},this.resetByGroup=function(e){let t=njt.dom.getElementsByAttributeWithValue("snip-group",e);if(t.length>0)for(let e=0;e<t.length;e++){let n=t[e].getAttribute("snip-id");n!==null&&typeof this.snipMap[n]!="undefined"&&(t[e].innerHTML=this.snipMap[n])}},this.initByClass=function(e){let n=0,t=njt.dom.getElementsByClass(e);for(let s=0;s<t.length;s++)t[s].getAttribute("snip-group")===null&&t[s].getAttribute("snip-id")===null&&(t[s].setAttribute("snip-group",e),snipId=e+njt.id.getLazyUniqueId(),t[s].setAttribute("snip-id",snipId),n++);return n},this.initByClassIdPair=function(e){let n=0,t=njt.dom.getElementsWhereClassBegins(e+"-"),s=e.length+2;for(let o=0;o<t.length;o++)for(let i=0;i<t[o].classList.length;i++){let a=t[o].classList[i];a.length>s&&a.substring(0,e.length)===e&&t[o].getAttribute("snip-group")===null&&t[o].getAttribute("snip-id")===null&&(t[o].setAttribute("snip-group",e),t[o].setAttribute("snip-id",a.substring(e.length+1)),n++)}return n}},njt.modal=new function(){this.initModal=function(){this.modalShell=document.createDocumentFragment();let e=document.createElement("div");e.setAttribute("id",this.modalBackgroundId),e.setAttribute("modal-element","background"),e.className=this.modalBackgroundClass;let t=document.createElement("div");t.setAttribute("id",this.modalFrameId),t.className=this.modalFrameClass;let s=document.createElement("div");s.setAttribute("id",this.modalCloseWrapperId);let n=document.createElement("span");n.innerHTML="&times;",n.className=this.modalCloseClass,n.setAttribute("id",this.modalCloseId),n.setAttribute("modal-element","close-button");let o=document.createElement("div");o.setAttribute("id",this.modalContentId),o.className=this.modalContentClass,s.appendChild(n),t.appendChild(s),t.appendChild(o),e.appendChild(t),this.modalShell.appendChild(e),document.addEventListener("mousedown",function(e){let t=e.target.getAttribute("modal-element");t!==null?e.offsetX<e.target.clientWidth&&(njt.modal.lastClick=t):njt.modal.lastClick=null}),document.addEventListener("mouseup",function(e){if(njt.modal.lastClick!==null){let t=e.target.getAttribute("modal-element");t===njt.modal.lastClick&&(t==="background"||t==="close-button")&&e.offsetX<e.target.clientWidth&&njt.modal.close(e),njt.modal.lastClick=null}})},this.loadModals=function(){let e=document.querySelectorAll("[modal-wrapper]"),t=null,n=null,s=null,o=e.length;for(let o=0;o<e.length;o++){for(t=e[o].getAttribute("modal-wrapper"),n=e[o].getAttribute("modal-open"),s=e[o].getAttribute("modal-close"),currentChildren=e[o].children,this.contentArray[t]={},this.contentArray[t].modal=document.createDocumentFragment();currentChildren.length>0;)this.contentArray[t].modal.appendChild(currentChildren[0]);typeof n=="string"?this.contentArray[t].open=n:this.contentArray[t].open=null,typeof s=="string"?this.contentArray[t].close=s:this.contentArray[t].close=null,e[o].parentNode.removeChild(e[o])}},this.open=function(e,t){njt.log("Trying To Open Modal"),this.contentArray[e].open!=null?(njt.log("Running Custom Open Modal Function"),njt.modal.openFunctions[this.contentArray[e].open](e,t)):this.openNow(e)},this.openNow=function(e){njt.log("Modal Open Started"),this.currentContentId===null&&typeof e=="string"&&typeof this.contentArray[e]!="undefined"&&(njt.modal.modalShell.querySelector("#"+this.modalContentId).appendChild(this.contentArray[e].modal),document.body.appendChild(this.modalShell),this.currentContentId=e),njt.log("Modal Open Ended")},this.close=function(e){njt.log("Trying To Close Modal"),this.contentArray[this.currentContentId].close!=null?(njt.log("Running Custom Close Modal Function"),njt.modal.closeFunctions[this.contentArray[this.currentContentId].close](e)):this.closeNow()},this.closeNow=function(){if(njt.log("Modal Close Started"),this.currentContentId!==null){let e=document.getElementById(this.modalContentId);for(;e.childNodes.length>0;)this.contentArray[this.currentContentId].modal.appendChild(e.childNodes[0]);this.modalShell.appendChild(document.getElementById(this.modalBackgroundId)),this.currentContentId=null}njt.log("Modal Close Ended")},this.modalShell=null,this.currentContentId=null,this.contentArray=[],this.modalBackgroundId="modal-background",this.modalBackgroundClass="modal-background",this.modalFrameId="modal-frame",this.modalFrameClass="modal-frame",this.modalCloseWrapperId="modal-close-wrapper",this.modalCloseId="modal-close-button",this.modalCloseClass="modal-close",this.modalContentId="modal-content",this.modalContentClass="modal-content",this.lastClick=null,this.contentArray=[],this.openFunctions={},this.closeFunctions={}},njt.event.queue.htmlloaded.push(function(){njt.log("Starting to initialise Modals"),njt.modal.initModal(),njt.modal.loadModals(),njt.log("Finished initialising Modals")}),njt.formbuilder=new function(){this.generate=function(e){let t=null;if(njt.js.typeOf(e)===njt.types.STRING&&(e=JSON.parse(e)),e.t==="njt/form"){if(t=njt.element.createElement("form",e.i,e.c,e.a),njt.js.typeOf(e.e)===njt.types.ARRAY)for(let n=0;n<e.e.length;n++){let s=this.parseElement(e.e[n]);s!==null&&t.appendChild(s)}if(njt.js.typeOf(e.w)===njt.types.OBJECT){let n=njt.element.createElement(e.w.t,e.w.i,e.w.c,e.w.a);n.appendChild(t),t=n}}return t},this.parseElement=function(e){let n=null,t=e.t.split("/");return t.length===3?t[0]==="njt"&&t[1]==="form"&&njt.js.typeOf(this.typeBuilders[t[2]])===njt.types.FUNCTION&&(n=this.typeBuilders[t[2]](e)):t.length===1&&(n=njt.element.buildElementTree(e)),n},this.typeBuilders={},this.typeBuilders.input=function(e){let t=null;if(njt.js.typeOf(e.i)===njt.types.STRING){let i=e.l,n=e.i,o={type:"text",class:"njt-form-input",name:n};njt.js.typeOf(e.p)===njt.types.STRING&&(o.placeholder=e.p),t=njt.element.createElement("div",n+"-wrapper",e.c);let s=njt.element.createElement("input",n+"-input",null,o);if(njt.js.typeOf(e.v)===njt.types.STRING&&s.setAttribute("value",e.v),njt.js.typeOf(e.l)===njt.types.STRING){let o=njt.element.createElement("label",n+"-label",null,{for:n+"-input"},e.l+s.outerHTML);t.appendChild(o)}else t.appendChild(s)}return t},this.typeBuilders.textarea=function(e){let t=null;if(njt.js.typeOf(e.i)===njt.types.STRING){let i=e.l,n=e.i,s={class:"njt-form-textarea",name:n};njt.js.typeOf(e.p)===njt.types.STRING&&(s.placeholder=e.p),njt.js.typeOf(e.r)===njt.types.NUMBER&&(s.rows=e.r);let a=null;t=njt.element.createElement("div",n+"-wrapper",e.c);let o=njt.element.createElement("textarea",n+"-input",null,s);if(njt.js.typeOf(e.v)===njt.types.STRING&&(o.innerHTML=e.v),njt.js.typeOf(e.l)===njt.types.STRING){let s=njt.element.createElement("label",n+"-label",null,{for:n+"-input"},e.l+o.outerHTML);t.appendChild(s)}else t.appendChild(o)}return t},this.typeBuilders.select=function(e){let t=null;if(njt.js.typeOf(e.i)===njt.types.STRING){let a=e.l,n=e.i,i={class:"njt-form-select",name:n},o=null;njt.js.typeOf(e.v)===njt.types.STRING&&(o=e.v),t=njt.element.createElement("div",n+"-wrapper",e.c);let s=njt.element.createElement("select",n+"-input",null,i);if(njt.js.typeOf(e.o)===njt.types.ARRAY)for(let t=0;t<e.o.length;t++)e.o[t].v===o?s.appendChild(njt.element.createElement("option",null,null,{value:e.o[t].v,selected:1},e.o[t].h)):s.appendChild(njt.element.createElement("option",null,null,{value:e.o[t].v},e.o[t].h));if(njt.js.typeOf(e.l)===njt.types.STRING){let o=njt.element.createElement("label",n+"-label",null,{for:n+"-input"},e.l+s.outerHTML);t.appendChild(o)}else t.appendChild(s)}return t},this.typeBuilders.datalist=function(e){let t=null;if(njt.js.typeOf(e.i)===njt.types.STRING){let a=e.l,n=e.i,o={type:"text",class:"njt-form-datalist",name:n,list:n+"-list"};njt.js.typeOf(e.p)===njt.types.STRING&&(o.placeholder=e.p),t=njt.element.createElement("div",n+"-wrapper",e.c);let s=njt.element.createElement("input",n+"-input",null,o);if(njt.js.typeOf(e.v)===njt.types.STRING&&s.setAttribute("value",e.v),njt.js.typeOf(e.l)===njt.types.STRING){let o=njt.element.createElement("label",n+"-label",null,{for:n+"-input"},e.l+s.outerHTML);t.appendChild(o)}else t.appendChild(s);let i=njt.element.createElement("datalist",n+"-list",null,null);if(njt.js.typeOf(e.o)===njt.types.ARRAY)for(let t=0;t<e.o.length;t++)i.appendChild(njt.element.createElement("option",null,null,{value:e.o[t].v},e.o[t].h));t.appendChild(i)}return t}}